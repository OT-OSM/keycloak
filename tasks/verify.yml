---
# -------------------------------------------------------------------
# Verify Keycloak service is running
# -------------------------------------------------------------------
- name: Wait for Keycloak service to become active
  ansible.builtin.command: systemctl is-active keycloak
  register: kc_service_status
  retries: 10
  delay: 10
  until: kc_service_status.stdout == "active"
  changed_when: false

# -------------------------------------------------------------------
# Informational: HTTPS configuration status
# (No port waiting to avoid runtime TLS dependency)
# -------------------------------------------------------------------
- name: Show HTTPS configuration status
  ansible.builtin.debug:
    msg: >
      Keycloak HTTPS is {{
        'ENABLED' if (keycloak_https_enabled | default(false) | bool)
        else 'DISABLED'
      }}.
      Runtime TLS binding depends on certificate validation.
