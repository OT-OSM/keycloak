---
# Validate platform compatibility

- name: Validate supported operating system
  assert:
    that:
      - ansible_distribution == "Ubuntu"
      - ansible_distribution_major_version | int >= 20
    fail_msg: >
      Unsupported OS detected.
      This role supports Ubuntu 20.04+ only.
    success_msg: >
      Supported OS detected.

- name: Validate Java runtime version
  assert:
    that:
      - java_version | int >= 17
    fail_msg: >
      Keycloak requires Java 17 or newer.

# Install base dependencies
- name: Install base packages
  apt:
    name:
      - curl
      - tar
      - python3-psycopg2
      - acl
    update_cache: yes