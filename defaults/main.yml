# ---------------- Database Management ----------------
keycloak_db_engine: "postgres"
keycloak_db_port: 5432
keycloak_db_host: "localhost"
keycloak_db_name: "keycloak"
keycloak_db_user: "keycloak"
keycloak_db_password: "change_me"
#keycloak_db_password: "{{ vault_keycloak_db_password }}"

# ---------------- Keycloak Versioning ----------------
# Keycloak 17+ (Quarkus-based). Tested with 26.x
keycloak_version: "26.0.7"
keycloak_archive_name: "keycloak-{{ keycloak_version }}.tar.gz"

keycloak_download_url: >
  https://github.com/keycloak/keycloak/releases/download/{{ keycloak_version }}/{{ keycloak_archive_name }}

# ---------------- Paths ----------------
keycloak_base_dir: "/opt/keycloak"
keycloak_versions_dir: "{{ keycloak_base_dir }}/versions"
keycloak_install_dir: "{{ keycloak_base_dir }}/current"
keycloak_tmp_dir: "/tmp"

keycloak_release_dir: "{{ keycloak_versions_dir }}/keycloak-{{ keycloak_version }}"

# ---------------- System User ----------------
keycloak_user: "keycloak"
keycloak_group: "keycloak"

# ---------------- Network ----------------
keycloak_http_port: 8080

# ---------------- Service / Runtime ----------------
keycloak_env_file: /etc/keycloak/keycloak.env

# ---------------- Realm Security ----------------
keycloak_realm_ssl_required: "NONE"   # NONE | EXTERNAL | ALL

# Public identity (DNS preferred, IP allowed for demo)
keycloak_public_hostname: ""

# true  = behind reverse proxy (Nginx / ALB)
# false = direct access
keycloak_use_reverse_proxy: false

# ---------------- TLS / HTTPS ----------------
# Enable HTTPS directly in Keycloak
keycloak_https_enabled: false

# Used only if keycloak_https_enabled = true
keycloak_https_port: 8443
keycloak_tls_cert_file: ""
keycloak_tls_key_file: ""

# ---------------- Reverse Proxy ----------------
# none | edge | reencrypt
keycloak_proxy_mode: "none"

# ---------------- Identity Providers (Optional) ----------------
# Enable external authentication providers via realm import
# Supported: OIDC, LDAP, SAML
# All providers are disabled by default

keycloak_identity_providers:
  oidc: false
  ldap: false
  saml: false

# ---------------- OIDC Identity Providers ----------------
# Example: Google, Azure AD, Keycloak Broker, etc.
# Used only if keycloak_identity_providers.oidc = true

keycloak_oidc_providers:
  - alias: "google"
    display_name: "Sign in with Google"
    issuer: "https://accounts.XXX.XXX"
    client_id: "<google-client-id>"
    client_secret: "<google-client-secret>"
    default_scopes: "https://<keycloak-domain>/realms/<realm>/broker/google/endpoint"

# ---------------- LDAP Identity Providers ----------------
# Used only if keycloak_identity_providers.ldap = true

keycloak_ldap_providers: []
# Example:
# keycloak_ldap_providers:
#   - name: "corp-ldap"
#     connection_url: "ldap://ldap.example.com"
#     users_dn: "ou=users,dc=example,dc=com"
#     bind_dn: "cn=admin,dc=example,dc=com"
#     bind_credential: "ldap_password"

# --------------- SAML Identity Providers ----------------
# Used only if keycloak_identity_providers.saml = true

keycloak_saml_providers: []
# Example:
# keycloak_saml_providers:
#   - alias: "corp-saml"
#     entity_id: "https://idp.example.com/entity"
#     single_sign_on_service_url: "https://idp.example.com/sso"
#     signing_certificate: "/etc/keycloak/saml/idp.crt"


# ---------------- Access Control ----------------
# Baseline access control support using realm import
# This creates realm roles and groups, and maps roles to groups.
# User assignment is expected to be managed via Keycloak UI or IdP claims.

# Enable baseline access control bootstrap
keycloak_access_control_enabled: false

# Realm name where roles and groups will be created
keycloak_realm_name: "master"

# ---------------- Realm Roles ----------------
# Default realm-level roles to create

keycloak_default_roles:
  - admin
  - developer
  - viewer

# ---------------- Groups ----------------
# Default groups to create inside the realm

keycloak_default_groups:
  - platform-admins
  - devops
  - developers
  - viewers

# ---------------- Group â†’ Role Mapping ----------------
# Maps realm roles to groups

keycloak_group_role_mappings:
  platform-admins:
    - admin
  devops:
    - admin
  developers:
    - developer
  viewers:
    - viewer


# ---------------- Observability ----------------
keycloak_observability_enabled: true

keycloak_management_port: 9000

keycloak_health_enabled: true
keycloak_metrics_enabled: true

keycloak_log_level: INFO
keycloak_log_format: json   # or json

# ---------------- Admin Bootstrap Control ----------------
keycloak_bootstrap_admin: true

# ---------------- Admin Bootstrap ----------------
keycloak_admin_user: "admin"
keycloak_admin_password: "Admin@123"

# ---------------- HA / CLUSTER ----------------
keycloak_ha_enabled: false          # DEFAULT OFF (global role safe)

# Logical cluster name (same on all nodes)
keycloak_cluster_name: keycloak-cluster

# Unique per node (auto from inventory)
keycloak_node_name: "{{ inventory_hostname }}"
