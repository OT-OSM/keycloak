# ---------------- DATABASE ----------------
db=postgres
db-url=jdbc:postgresql://{{ keycloak_db_host }}:{{ keycloak_db_port }}/{{ keycloak_db_name }}
db-username={{ keycloak_db_user }}
db-password={{ keycloak_db_password }}

# ---------------- HTTP ----------------
http-enabled=true
http-port={{ keycloak_http_port | default(8080) }}
http-host=0.0.0.0

# ---------------- DEV MODE OVERRIDES ----------------
hostname-strict-https=false

# ---------------- PROXY (IMPORTANT) ----------------
proxy={{ keycloak_proxy_mode }}

{% if not keycloak_use_reverse_proxy %}
hostname-url=http://{{ keycloak_public_hostname }}:{{ keycloak_http_port }}
hostname-strict=false
hostname-strict-https=false
{% else %}
hostname-strict=false
hostname-strict-https=false
{% endif %}

# ---------------- OBSERVABILITY ----------------
{% if keycloak_observability_enabled | bool %}
http-management-enabled=true
http-management-port={{ keycloak_management_port | default(9000) }}
http-management-host=0.0.0.0

{% if keycloak_metrics_enabled | bool %}
metrics-enabled=true
{% endif %}

{% if keycloak_health_enabled | bool %}
health-enabled=true
{% endif %}

log-level={{ keycloak_log_level | default("INFO") }}

{% if keycloak_log_format == "json" %}
log-console-output=json
{% endif %}
{% endif %}
