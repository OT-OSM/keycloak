# ---------------- PostgreSQL ----------------
postgres_port: 5432
postgres_host: "localhost"

keycloak_db_name: "keycloak"
keycloak_db_user: "keycloak"
keycloak_db_password: "change_me"

# ---------------- Keycloak Versioning ----------------
# Keycloak 17+ (Quarkus-based). Tested with 26.x
keycloak_version: "26.0.7"

keycloak_archive_name: "keycloak-{{ keycloak_version }}.tar.gz"

keycloak_download_url: >
  https://github.com/keycloak/keycloak/releases/download/{{ keycloak_version }}/{{ keycloak_archive_name }}

# ---------------- Paths ----------------
keycloak_base_dir: "/opt"
keycloak_versions_dir: "{{ keycloak_base_dir }}"
keycloak_install_dir: "/opt/keycloak"
keycloak_tmp_dir: "/tmp"

# ---------------- Database Control ----------------
# DB provisioning should be external by default
keycloak_manage_db: false


# ---------------- Admin Bootstrap ----------------
keycloak_admin_user: "admin"
keycloak_admin_password: "change_me"

# ---------------- Network ----------------
keycloak_http_port: 8080
keycloak_hostname: "localhost"

# ---------------- Java ----------------
# Keycloak requires Java 17+
java_version: "21"

# ---------------- System User ----------------
keycloak_user: "keycloak"
keycloak_group: "keycloak"

# ---------------- TLS / HTTPS ----------------
# Enable HTTPS directly in Keycloak
keycloak_https_enabled: false

# Used only if keycloak_https_enabled = true
keycloak_https_port: 8443
keycloak_tls_cert_file: ""
keycloak_tls_key_file: ""

# ---------------- Reverse Proxy ----------------
# none | edge | reencrypt
keycloak_proxy_mode: "none"

# ---------------- Identity Providers (Optional) ----------------
# Enable external authentication providers via realm import
# Supported: OIDC, LDAP, SAML
# All providers are disabled by default

keycloak_identity_providers:
  oidc: false
  ldap: false
  saml: false

# ---------------- OIDC Identity Providers ----------------
# Example: Google, Azure AD, Keycloak Broker, etc.
# Used only if keycloak_identity_providers.oidc = true

keycloak_oidc_providers: []
# Example:
# keycloak_oidc_providers:
#   - alias: "google"
#     display_name: "Google Login"
#     issuer: "https://accounts.google.com"
#     client_id: "xxxxx"
#     client_secret: "yyyyy"
#     default_scopes: "openid profile email"

# ---------------- LDAP Identity Providers ----------------
# Used only if keycloak_identity_providers.ldap = true

keycloak_ldap_providers: []
# Example:
# keycloak_ldap_providers:
#   - name: "corp-ldap"
#     connection_url: "ldap://ldap.example.com"
#     users_dn: "ou=users,dc=example,dc=com"
#     bind_dn: "cn=admin,dc=example,dc=com"
#     bind_credential: "ldap_password"

# ---------------- SAML Identity Providers ----------------
# Used only if keycloak_identity_providers.saml = true

keycloak_saml_providers: []
# Example:
# keycloak_saml_providers:
#   - alias: "corp-saml"
#     entity_id: "https://idp.example.com/entity"
#     single_sign_on_service_url: "https://idp.example.com/sso"
#     signing_certificate: "/etc/keycloak/saml/idp.crt"

# ---------------- High Availability (HA) ----------------

keycloak_ha_enabled: false

# Node identity (unique per node)
keycloak_node_name: "{{ inventory_hostname }}"

# Cache / clustering
keycloak_cache_stack: "tcp"   # tcp | udp | kubernetes | dns

# JGroups TCP discovery
keycloak_jgroups_initial_hosts: []
# Example:
# keycloak_jgroups_initial_hosts:
#   - "10.0.0.10[7600]"
#   - "10.0.0.11[7600]"

# Cache ownership
keycloak_cache_owners: 2

# Proxy / LB awareness (important for HA)
keycloak_proxy_address_forwarding: true

